<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>파이썬 업무 자동화 교육 교안 - 챕터 4</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    <style>
        body {
            margin: 0;
            padding: 0;
            overflow: visible;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        .slide-container {
            width: 100%; max-width: 1920px;
            min-height: 720px;
            margin: 0 auto;
            overflow: visible;
            position: relative;
            background: linear-gradient(135deg, #1a365d 0%, #2d3748 100%);
            color: #fff;
        }
        .pattern-bg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.05'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
            opacity: 0.3;
        }
        .content {
            position: relative;
            z-index: 1;
            padding: 50px 60px;
        }
        .header {
            display: flex;
            align-items: center;
            margin-bottom: 30px;
        }
        .page-number {
            background: #4B8BBE;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 18px;
            margin-right: 20px;
        }
        .title {
            font-size: 44px;
            font-weight: 700;
            color: #FFD43B;
        }
        .project-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 25px;
            margin-bottom: 30px;
        }
        .prompt-box {
            background-color: rgba(75, 139, 190, 0.3);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            grid-column: span 2;
        }
        .prompt-title {
            font-size: 20px;
            font-weight: 600;
            color: #FFD43B;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
        }
        .prompt-title i {
            margin-right: 10px;
        }
        .prompt-content {
            font-size: 16px;
            color: #e2e8f0;
            line-height: 1.5;
            padding: 10px;
            background-color: rgba(0, 0, 0, 0.2);
            border-radius: 8px;
        }
        .library-card {
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 20px;
            height: 100%;
            display: flex;
            flex-direction: column;
        }
        .library-header {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }
        .library-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(45deg, #4B8BBE, #306998);
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
        }
        .library-icon i {
            font-size: 18px;
            color: #FFD43B;
        }
        .library-title {
            font-size: 22px;
            font-weight: 600;
            color: #e2e8f0;
        }
        .library-content {
            flex-grow: 1;
        }
        .library-description {
            font-size: 15px;
            color: #e2e8f0;
            line-height: 1.5;
            margin-bottom: 15px;
        }
        .code-snippet {
            background-color: rgba(0, 0, 0, 0.2);
            border-radius: 8px;
            padding: 15px;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 13px;
            line-height: 1.5;
            color: #e2e8f0;
            overflow-x: auto;
            margin-top: auto;
        }
        .feature-list {
            margin-top: 10px;
        }
        .feature-item {
            display: flex;
            align-items: flex-start;
            margin-bottom: 8px;
        }
        .feature-icon {
            color: #FFD43B;
            margin-right: 8px;
            font-size: 14px;
            margin-top: 3px;
        }
        .feature-text {
            font-size: 14px;
            color: #e2e8f0;
            line-height: 1.4;
        }
        .project-example {
            background-color: rgba(75, 139, 190, 0.2);
            border-radius: 12px;
            padding: 20px;
            grid-column: span 2;
        }
        .project-title {
            font-size: 22px;
            font-weight: 600;
            color: #FFD43B;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
        }
        .project-title i {
            margin-right: 10px;
        }
        .project-description {
            font-size: 15px;
            color: #e2e8f0;
            line-height: 1.5;
            margin-bottom: 15px;
        }
        .project-steps {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
        }
        .step {
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            padding: 12px;
            width: 23%;
            position: relative;
            text-align: center;
        }
        .step:not(:last-child):after {
            content: "→";
            position: absolute;
            right: -15px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 20px;
            color: #FFD43B;
        }
        .step-number {
            background-color: rgba(75, 139, 190, 0.6);
            width: 28px;
            height: 28px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 8px;
            font-weight: bold;
            font-size: 14px;
        }
        .step-text {
            font-size: 14px;
            color: #e2e8f0;
        }
        .footer {
            font-size: 16px;
            color: #a0aec0;
            text-align: center;
            margin-top: 20px;
            font-style: italic;
        }
        .highlight {
            color: #FFD43B;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="slide-container">
        <div class="pattern-bg"></div>
        <div class="content">
            <div class="header">
                <div class="page-number">7</div>
                <div class="title">통합 자동화 프로젝트 실습</div>
            </div>
            
            <div class="prompt-box">
                <div class="prompt-title">
                    <i class="fas fa-robot"></i>
                    ChatGPT 프롬프트
                </div>
                <div class="prompt-content">
                    "여러 개의 부서별 판매 데이터 엑셀 파일을 읽어서, 데이터를 통합하고 분석한 후, 차트와 요약 정보가 포함된 PDF 보고서를 자동으로 생성하는 파이썬 코드를 작성해주세요. 각 단계별로 주석을 포함해주세요."
                </div>
            </div>
            
            <div class="project-example">
                <div class="project-title">
                    <i class="fas fa-briefcase"></i>
                    통합 보고서 자동화 프로젝트
                </div>
                <div class="project-description">
                    여러 부서의 판매 데이터를 취합하여 종합 보고서를 자동으로 생성하는 프로젝트입니다. 이 자동화 솔루션은 데이터 수집부터 분석, 시각화, 보고서 생성까지 전체 업무 프로세스를 자동화합니다.
                </div>
                <div class="project-steps">
                    <div class="step">
                        <div class="step-number">1</div>
                        <div class="step-text">데이터 수집<br/><small>(pandas)</small></div>
                    </div>
                    <div class="step">
                        <div class="step-number">2</div>
                        <div class="step-text">데이터 분석<br/><small>(pandas, numpy)</small></div>
                    </div>
                    <div class="step">
                        <div class="step-number">3</div>
                        <div class="step-text">데이터 시각화<br/><small>(matplotlib)</small></div>
                    </div>
                    <div class="step">
                        <div class="step-number">4</div>
                        <div class="step-text">보고서 생성<br/><small>(reportlab)</small></div>
                    </div>
                </div>
                <div class="code-snippet">
                    <pre style="margin: 0;">
import os
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
from reportlab.lib.pagesizes import letter
from reportlab.platypus import SimpleDocTemplate, Paragraph, Spacer, Image, Table, TableStyle
from reportlab.lib.styles import getSampleStyleSheet
from reportlab.lib import colors
import datetime

def generate_sales_report(data_folder, output_pdf):
    """
    여러 부서 판매 데이터 파일을 통합하여 PDF 보고서 생성
    
    Args:
        data_folder: 부서별 엑셀 파일이 있는 폴더 경로
        output_pdf: 출력할 PDF 파일 경로
    """
    # 1. 데이터 수집 및 통합
    all_data = []
    for file in os.listdir(data_folder):
        if file.endswith('.xlsx'):
            file_path = os.path.join(data_folder, file)
            # 부서명 추출 (파일명에서)
            department = file.split('_')[0]
            
            # 파일 읽기
            df = pd.read_excel(file_path)
            df['부서'] = department  # 부서 정보 추가
            all_data.append(df)
    
    # 모든 데이터 통합
    if not all_data:
        print("데이터 파일을 찾을 수 없습니다.")
        return
        
    combined_data = pd.concat(all_data, ignore_index=True)
    
    # 2. 데이터 분석
    # 부서별 총 매출 계산
    dept_sales = combined_data.groupby('부서')['매출액'].sum().reset_index()
    # 제품별 매출 계산
    product_sales = combined_data.groupby('제품명')['매출액'].sum().sort_values(ascending=False).head(5)
    # 월별 매출 추이 (날짜 컬럼을 월 단위로 그룹화)
    combined_data['날짜'] = pd.to_datetime(combined_data['날짜'])
    combined_data['월'] = combined_data['날짜'].dt.strftime('%Y-%m')
    monthly_sales = combined_data.groupby('월')['매출액'].sum()
    
    # 3. 데이터 시각화
    # 그래프를 저장할 임시 폴더 생성
    temp_dir = 'temp_charts'
    os.makedirs(temp_dir, exist_ok=True)
    
    # 부서별 매출 파이 차트
    plt.figure(figsize=(8, 6))
    plt.pie(dept_sales['매출액'], labels=dept_sales['부서'], autopct='%1.1f%%')
    plt.title('부서별 매출 비중')
    dept_chart_path = os.path.join(temp_dir, 'dept_sales.png')
    plt.savefig(dept_chart_path)
    plt.close()
    
    # 제품별 매출 바 차트
    plt.figure(figsize=(10, 6))
    plt.bar(product_sales.index, product_sales.values)
    plt.title('상위 5개 제품 매출')
    plt.ylabel('매출액')
    plt.xticks(rotation=45, ha='right')
    product_chart_path = os.path.join(temp_dir, 'product_sales.png')
    plt.savefig(product_chart_path)
    plt.close()
    
    # 월별 매출 추이 선 그래프
    plt.figure(figsize=(10, 6))
    plt.plot(monthly_sales.index, monthly_sales.values, marker='o')
    plt.title('월별 매출 추이')
    plt.ylabel('매출액')
    plt.xticks(rotation=45)
    monthly_chart_path = os.path.join(temp_dir, 'monthly_sales.png')
    plt.savefig(monthly_chart_path)
    plt.close()
    
    # 4. PDF 보고서 생성
    doc = SimpleDocTemplate(output_pdf, pagesize=letter)
    styles = getSampleStyleSheet()
    story = []
    
    # 보고서 제목
    title = Paragraph(f"판매 종합 보고서 ({datetime.datetime.now().strftime('%Y-%m-%d')})", styles['Title'])
    story.append(title)
    story.append(Spacer(1, 20))
    
    # 보고서 소개
    intro = Paragraph("이 보고서는 각 부서의 판매 데이터를 분석하여 생성된 자동화 보고서입니다.", styles['Normal'])
    story.append(intro)
    story.append(Spacer(1, 20))
    
    # 주요 지표 요약
    story.append(Paragraph("주요 지표 요약", styles['Heading2']))
    total_sales = combined_data['매출액'].sum()
    avg_sales = combined_data['매출액'].mean()
    max_dept = dept_sales.loc[dept_sales['매출액'].idxmax()]['부서']
    
    data = [
        ["총 매출", f"{total_sales:,.0f}원"],
        ["평균 거래 금액", f"{avg_sales:,.0f}원"],
        ["최고 매출 부서", max_dept]
    ]
    
    t = Table(data, colWidths=[200, 300])
    t.setStyle(TableStyle([
        ('BACKGROUND', (0, 0), (0, -1), colors.lightblue),
        ('TEXTCOLOR', (0, 0), (0, -1), colors.white),
        ('ALIGN', (0, 0), (-1, -1), 'CENTER'),
        ('FONTNAME', (0, 0), (-1, 0), 'Helvetica-Bold'),
        ('BOTTOMPADDING', (0, 0), (-1, 0), 12),
        ('GRID', (0, 0), (-1, -1), 1, colors.black)
    ]))
    story.append(t)
    story.append(Spacer(1, 20))
    
    # 차트 추가
    story.append(Paragraph("부서별 매출 비중", styles['Heading2']))
    story.append(Image(dept_chart_path, width=400, height=300))
    story.append(Spacer(1, 20))
    
    story.append(Paragraph("상위 5개 제품 매출", styles['Heading2']))
    story.append(Image(product_chart_path, width=400, height=250))
    story.append(Spacer(1, 20))
    
    story.append(Paragraph("월별 매출 추이", styles['Heading2']))
    story.append(Image(monthly_chart_path, width=400, height=250))
    
    # PDF 생성
    doc.build(story)
    
    # 임시 파일 정리
    for file in os.listdir(temp_dir):
        os.remove(os.path.join(temp_dir, file))
    os.rmdir(temp_dir)
    
    print(f"보고서가 성공적으로 생성되었습니다: {output_pdf}")

# 실행 예
# generate_sales_report("sales_data", "sales_report.pdf")</pre>
                </div>
            </div>
            
            <div class="project-grid">
                <div class="library-card">
                    <div class="library-header">
                        <div class="library-icon">
                            <i class="fas fa-puzzle-piece"></i>
                        </div>
                        <div class="library-title">코드 구성 설명</div>
                    </div>
                    <div class="library-content">
                        <div class="feature-list">
                            <div class="feature-item">
                                <div class="feature-icon"><i class="fas fa-check-circle"></i></div>
                                <div class="feature-text"><strong class="highlight">모듈화된 접근방식:</strong> 전체 작업이 하나의 함수로 캡슐화되어 있어 다른 프로그램에서도 쉽게 재사용할 수 있습니다.</div>
                            </div>
                            <div class="feature-item">
                                <div class="feature-icon"><i class="fas fa-check-circle"></i></div>
                                <div class="feature-text"><strong class="highlight">데이터 통합:</strong> pandas를 사용하여 여러 엑셀 파일의 데이터를 효율적으로 결합하고 정리합니다.</div>
                            </div>
                            <div class="feature-item">
                                <div class="feature-icon"><i class="fas fa-check-circle"></i></div>
                                <div class="feature-text"><strong class="highlight">다양한 분석:</strong> 부서별, 제품별, 시간별로 다각적인 데이터 분석을 수행합니다.</div>
                            </div>
                            <div class="feature-item">
                                <div class="feature-icon"><i class="fas fa-check-circle"></i></div>
                                <div class="feature-text"><strong class="highlight">시각적 표현:</strong> matplotlib을 활용하여 여러 유형의 차트를 생성하여 데이터를 시각화합니다.</div>
                            </div>
                            <div class="feature-item">
                                <div class="feature-icon"><i class="fas fa-check-circle"></i></div>
                                <div class="feature-text"><strong class="highlight">전문적인 보고서:</strong> ReportLab을 사용하여 표, 차트, 텍스트가 포함된 전문적인 PDF 보고서를 생성합니다.</div>
                            </div>
                            <div class="feature-item">
                                <div class="feature-icon"><i class="fas fa-check-circle"></i></div>
                                <div class="feature-text"><strong class="highlight">리소스 관리:</strong> 임시 파일을 생성하고 작업 완료 후 정리하는 과정이 포함되어 있습니다.</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="library-card">
                    <div class="library-header">
                        <div class="library-icon">
                            <i class="fas fa-lightbulb"></i>
                        </div>
                        <div class="library-title">실무 활용 팁</div>
                    </div>
                    <div class="library-content">
                        <div class="library-description">
                            이 자동화 프로젝트는 판매 데이터 분석뿐만 아니라 다양한 업무 영역에서 활용할 수 있습니다. 데이터 소스와 분석 방법, 시각화 유형을 변경하여 다음과 같은 다양한 비즈니스 요구에 맞게 조정할 수 있습니다:
                        </div>
                        <div class="feature-list">
                            <div class="feature-item">
                                <div class="feature-icon"><i class="fas fa-chart-pie"></i></div>
                                <div class="feature-text"><strong class="highlight">재무 보고서:</strong> 월별 지출, 예산 대비 실제 지출, 부서별 비용 분석 등</div>
                            </div>
                            <div class="feature-item">
                                <div class="feature-icon"><i class="fas fa-users"></i></div>
                                <div class="feature-text"><strong class="highlight">인사 데이터 분석:</strong> 직원 성과, 부서별 생산성, 출결 통계 등</div>
                            </div>
                            <div class="feature-item">
                                <div class="feature-icon"><i class="fas fa-warehouse"></i></div>
                                <div class="feature-text"><strong class="highlight">재고 관리:</strong> 재고 수준, 입출고 현황, 재고 회전율 분석 등</div>
                            </div>
                            <div class="feature-item">
                                <div class="feature-icon"><i class="fas fa-tasks"></i></div>
                                <div class="feature-text"><strong class="highlight">프로젝트 관리:</strong> 일정 진행 상황, 리소스 할당, 비용 추적 등</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="footer">
                "여러 라이브러리를 통합하여 사용하면 복잡한 업무 프로세스도 자동화할 수 있습니다."
            </div>
        </div>
    </div>
</body>
    