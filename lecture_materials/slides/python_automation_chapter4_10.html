<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>파이썬 업무 자동화 교육 교안 - 챕터 4</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    <style>
        body {
            margin: 0;
            padding: 0;
            overflow: visible;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        .slide-container {
            width: 100%; max-width: 1920px;
            min-height: 720px;
            margin: 0 auto;
            overflow: visible;
            position: relative;
            background: linear-gradient(135deg, #1a365d 0%, #2d3748 100%);
            color: #fff;
        }
        .pattern-bg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.05'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
            opacity: 0.3;
        }
        .content {
            position: relative;
            z-index: 1;
            padding: 50px 60px;
        }
        .header {
            display: flex;
            align-items: center;
            margin-bottom: 30px;
        }
        .page-number {
            background: #4B8BBE;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 18px;
            margin-right: 20px;
        }
        .title {
            font-size: 44px;
            font-weight: 700;
            color: #FFD43B;
        }
        .case-study-section {
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 30px;
        }
        .section-title {
            font-size: 24px;
            font-weight: 600;
            color: #e2e8f0;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
        }
        .section-title i {
            color: #FFD43B;
            margin-right: 12px;
        }
        .case-description {
            font-size: 16px;
            line-height: 1.6;
            color: #e2e8f0;
            margin-bottom: 20px;
        }
        .tech-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 15px;
        }
        .tag {
            background-color: rgba(75, 139, 190, 0.4);
            border-radius: 20px;
            padding: 5px 15px;
            font-size: 14px;
            color: #fff;
            display: flex;
            align-items: center;
        }
        .tag i {
            margin-right: 6px;
            color: #FFD43B;
        }
        .implementation-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        .implementation-box {
            background-color: rgba(0, 0, 0, 0.2);
            border-radius: 8px;
            padding: 15px;
        }
        .box-title {
            font-size: 18px;
            font-weight: 600;
            color: #FFD43B;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
        }
        .box-title i {
            margin-right: 8px;
        }
        .code-snippet {
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 13px;
            line-height: 1.5;
            color: #e2e8f0;
            white-space: pre-wrap;
            word-wrap: break-word;
            overflow-x: auto;
            max-height: 200px;
            overflow-y: auto;
        }
        .highlight {
            color: #FFD43B;
            font-weight: bold;
        }
        .outcomes-section {
            background-color: rgba(75, 139, 190, 0.2);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 30px;
        }
        .outcomes-title {
            font-size: 22px;
            font-weight: 600;
            color: #FFD43B;
            margin-bottom: 15px;
        }
        .outcomes-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
        }
        .outcome-card {
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            padding: 15px;
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
        }
        .outcome-icon {
            font-size: 30px;
            color: #4B8BBE;
            margin-bottom: 10px;
        }
        .outcome-text {
            font-size: 14px;
            color: #e2e8f0;
            line-height: 1.4;
        }
        .resources-section {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
        }
        .resource-card {
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 15px;
            text-align: center;
        }
        .resource-icon {
            font-size: 26px;
            color: #FFD43B;
            margin-bottom: 10px;
        }
        .resource-title {
            font-size: 16px;
            font-weight: 600;
            color: #e2e8f0;
            margin-bottom: 8px;
        }
        .resource-text {
            font-size: 13px;
            color: #cbd5e0;
            line-height: 1.4;
        }
        .footer {
            font-size: 16px;
            color: #a0aec0;
            text-align: center;
            margin-top: 20px;
            font-style: italic;
        }
    </style>
</head>
<body>
    <div class="slide-container">
        <div class="pattern-bg"></div>
        <div class="content">
            <div class="header">
                <div class="page-number">11</div>
                <div class="title">실무 적용 사례 연구</div>
            </div>
            
            <div class="case-study-section">
                <div class="section-title">
                    <i class="fas fa-briefcase"></i>
                    일간 보고서 자동화 시스템
                </div>
                <div class="case-description">
                    금융 회사에서는 매일 수백 개의 거래 기록이 포함된 CSV 파일이 생성됩니다. 이전에는 데이터 분석가가 수작업으로 데이터를 처리하고 보고서를 작성했지만, 이제 파이썬 자동화 스크립트를 통해 이 과정을 자동화했습니다. 스크립트는 매일 아침 5시에 자동으로 실행되어 전날의 거래 데이터를 분석하고, 주요 지표를 계산한 후, PDF 보고서를 생성하여 관련 부서에 이메일로 자동 발송합니다.
                </div>
                <div class="tech-tags">
                    <div class="tag"><i class="fas fa-exclamation-triangle"></i> 예외 처리</div>
                    <div class="tag"><i class="fas fa-code"></i> 함수형 프로그래밍</div>
                    <div class="tag"><i class="fas fa-chart-bar"></i> Pandas/Matplotlib</div>
                    <div class="tag"><i class="fas fa-file-pdf"></i> ReportLab</div>
                    <div class="tag"><i class="fas fa-envelope"></i> SMTP 이메일</div>
                    <div class="tag"><i class="fas fa-calendar-alt"></i> 작업 스케줄링</div>
                    <div class="tag"><i class="fas fa-robot"></i> ChatGPT 코드 생성</div>
                </div>
                <div class="implementation-grid">
                    <div class="implementation-box">
                        <div class="box-title">
                            <i class="fas fa-code-branch"></i>
                            구현 핵심 부분 - 예외 처리
                        </div>
                        <div class="code-snippet">
# ChatGPT 프롬프트: "CSV 파일을 읽을 때 발생할 수 있는 다양한 예외를 처리하는 코드를 작성해주세요."

def process_daily_data(csv_file_path):
    """일일 거래 데이터를 처리하는 함수"""
    import pandas as pd
    import logging
    
    logging.basicConfig(
        filename='data_processing.log',
        level=logging.INFO,
        format='%(asctime)s - %(levelname)s - %(message)s'
    )
    
    try:
        # 1. CSV 파일 읽기 시도
        try:
            df = pd.read_csv(csv_file_path)
            logging.info(f"파일 {csv_file_path} 성공적으로 로드됨")
        except FileNotFoundError:
            logging.error(f"파일을 찾을 수 없음: {csv_file_path}")
            raise
        except pd.errors.EmptyDataError:
            logging.error(f"빈 CSV 파일: {csv_file_path}")
            raise
        except pd.errors.ParserError:
            logging.error(f"CSV 파싱 오류: {csv_file_path}")
            raise
            
        # 2. 데이터 유효성 검사
        required_columns = ['Transaction_ID', 'Amount', 'Type']
        missing_columns = [col for col in required_columns if col not in df.columns]
        
        if missing_columns:
            error_msg = f"필수 열 누락: {', '.join(missing_columns)}"
            logging.error(error_msg)
            raise ValueError(error_msg)
            
        return df
        
    except Exception as e:
        # 예상치 못한 오류 처리
        logging.error(f"데이터 처리 중 오류 발생: {str(e)}")
        
        # 폴백 메커니즘: 이전 보고서 재사용
        logging.info("이전 데이터로 대체합니다.")
        return fallback_data()  # 폴백 함수 호출</div>
                    </div>
                    <div class="implementation-box">
                        <div class="box-title">
                            <i class="fas fa-file-alt"></i>
                            구현 핵심 부분 - 보고서 생성 및 전송
                        </div>
                        <div class="code-snippet">
# ChatGPT 프롬프트: "분석된 데이터를 PDF 보고서로 만들고 이메일로 전송하는 파이썬 함수를 작성해주세요."

def generate_and_send_report(df, recipient_list):
    """분석된 데이터로 보고서 생성 및 이메일 전송"""
    from reportlab.lib.pagesizes import letter
    from reportlab.pdfgen import canvas
    from reportlab.lib import colors
    from reportlab.platypus import SimpleDocTemplate, Table, TableStyle, Paragraph
    from reportlab.lib.styles import getSampleStyleSheet
    import matplotlib.pyplot as plt
    import smtplib
    from email.mime.multipart import MIMEMultipart
    from email.mime.text import MIMEText
    from email.mime.application import MIMEApplication
    import os
    from datetime import datetime
    
    # 1. 보고서를 위한 주요 지표 계산
    total_transactions = len(df)
    total_amount = df['Amount'].sum()
    avg_amount = df['Amount'].mean()
    by_type = df.groupby('Type')['Amount'].agg(['sum', 'count'])
    
    # 2. 그래프 생성
    plt.figure(figsize=(8, 6))
    by_type['sum'].plot(kind='pie', autopct='%1.1f%%')
    plt.title('거래 유형별 금액 비중')
    plt.tight_layout()
    chart_path = 'transaction_chart.png'
    plt.savefig(chart_path)
    plt.close()
    
    # 3. PDF 보고서 생성
    today = datetime.now().strftime('%Y-%m-%d')
    report_path = f'Daily_Report_{today}.pdf'
    
    doc = SimpleDocTemplate(report_path, pagesize=letter)
    styles = getSampleStyleSheet()
    elements = []
    
    # 제목 추가
    title = Paragraph(f"일간 거래 보고서 ({today})", styles['Title'])
    elements.append(title)
    
    # 주요 지표 테이블 추가
    data = [
        ['지표', '값'],
        ['총 거래 건수', f"{total_transactions:,}건"],
        ['총 거래 금액', f"₩{total_amount:,.0f}"],
        ['평균 거래 금액', f"₩{avg_amount:,.0f}"]
    ]
    
    table = Table(data, colWidths=[200, 200])
    table.setStyle(TableStyle([
        ('BACKGROUND', (0, 0), (1, 0), colors.blue),
        ('TEXTCOLOR', (0, 0), (1, 0), colors.white),
        ('ALIGN', (0, 0), (-1, -1), 'CENTER'),
        ('FONTNAME', (0, 0), (-1, 0), 'Helvetica-Bold'),
        ('GRID', (0, 0), (-1, -1), 1, colors.black),
    ]))
    
    elements.append(table)
    doc.build(elements)
    
    # 4. 이메일 전송
    try:
        msg = MIMEMultipart()
        msg['Subject'] = f'일간 거래 보고서 ({today})'
        msg['From'] = os.getenv('EMAIL_SENDER')
        
        # 본문 추가
        body = f"""
        안녕하세요,
        
        첨부된 {today} 일간 거래 보고서를 확인해 주세요.
        
        주요 지표:
        - 총 거래 건수: {total_transactions:,}건
        - 총 거래 금액: ₩{total_amount:,.0f}
        - 평균 거래 금액: ₩{avg_amount:,.0f}
        
        질문이 있으시면 회신해 주세요.
        """
        
        msg.attach(MIMEText(body, 'plain'))
        
        # PDF 첨부
        with open(report_path, 'rb') as f:
            attachment = MIMEApplication(f.read(), _subtype='pdf')
            attachment.add_header('Content-Disposition', 'attachment', filename=os.path.basename(report_path))
            msg.attach(attachment)
        
        # SMTP 서버 연결 및 전송
        with smtplib.SMTP('smtp.gmail.com', 587) as server:
            server.starttls()
            server.login(os.getenv('EMAIL_SENDER'), os.getenv('EMAIL_PASSWORD'))
            
            for recipient in recipient_list:
                msg['To'] = recipient
                server.send_message(msg)
                print(f"보고서가 {recipient}에게 전송되었습니다.")
                
        return True
        
    except Exception as e:
        print(f"이메일 전송 중 오류 발생: {e}")
        return False</div>
                    </div>
                </div>
            </div>
            
            <div class="outcomes-section">
                <div class="outcomes-title">자동화 시스템 도입 성과</div>
                <div class="outcomes-grid">
                    <div class="outcome-card">
                        <div class="outcome-icon"><i class="fas fa-clock"></i></div>
                        <div class="outcome-text">일일 <span class="highlight">3시간</span>의 수작업이 <span class="highlight">5분</span> 이내의 자동화 프로세스로 대체됨</div>
                    </div>
                    <div class="outcome-card">
                        <div class="outcome-icon"><i class="fas fa-chart-line"></i></div>
                        <div class="outcome-text">데이터 분석 정확도가 <span class="highlight">95%</span>에서 <span class="highlight">99.9%</span>로 향상됨</div>
                    </div>
                    <div class="outcome-card">
                        <div class="outcome-icon"><i class="fas fa-money-bill-wave"></i></div>
                        <div class="outcome-text">연간 약 <span class="highlight">6,500만원</span>의 인건비 절감 효과</div>
                    </div>
                    <div class="outcome-card">
                        <div class="outcome-icon"><i class="fas fa-exclamation-triangle"></i></div>
                        <div class="outcome-text">견고한 예외 처리로 <span class="highlight">99.7%</span>의 시스템 안정성 확보</div>
                    </div>
                    <div class="outcome-card">
                        <div class="outcome-icon"><i class="fas fa-users"></i></div>
                        <div class="outcome-text">데이터 분석가들이 <span class="highlight">전략적 분석</span>에 더 많은 시간 투자 가능</div>
                    </div>
                    <div class="outcome-card">
                        <div class="outcome-icon"><i class="fas fa-expand-arrows-alt"></i></div>
                        <div class="outcome-text">추가 개발 없이 <span class="highlight">다른 부서</span>로 시스템 확장 용이</div>
                    </div>
                </div>
            </div>
            
            <div class="resources-section">
                <div class="resource-card">
                    <div class="resource-icon"><i class="fas fa-book"></i></div>
                    <div class="resource-title">학습 자료</div>
                    <div class="resource-text">파이썬 자동화 관련 서적, 온라인 강의 및 튜토리얼 리소스 모음</div>
                </div>
                <div class="resource-card">
                    <div class="resource-icon"><i class="fas fa-code"></i></div>
                    <div class="resource-title">코드 템플릿</div>
                    <div class="resource-text">자주 사용되는 자동화 스크립트와 함수의 재사용 가능한 템플릿</div>
                </div>
                <div class="resource-card">
                    <div class="resource-icon"><i class="fas fa-robot"></i></div>
                    <div class="resource-title">ChatGPT 프롬프트</div>
                    <div class="resource-text">업무 자동화 코드 생성에 최적화된 프롬프트 예시 모음</div>
                </div>
                <div class="resource-card">
                    <div class="resource-icon"><i class="fas fa-clipboard-check"></i></div>
                    <div class="resource-title">체크리스트</div>
                    <div class="resource-text">자동화 스크립트 개발 및 배포 시 고려해야 할 사항들</div>
                </div>
            </div>
            
            <div class="footer">
                "업무 자동화는 단순한 시간 절약을 넘어 조직의 생산성과 데이터 품질을 혁신적으로 향상시킵니다."
            </div>
        </div>
    </div>
</body>
    