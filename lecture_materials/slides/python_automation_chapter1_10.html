<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>파이썬 업무 자동화 교육 교안 - 챕터 1</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    <style>
        body {
            margin: 0;
            padding: 0;
            overflow: visible;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        .slide-container {
            width: 100%; max-width: 1920px;
            min-height: 720px;
            margin: 0 auto;
            overflow: visible;
            position: relative;
            background: linear-gradient(135deg, #1a365d 0%, #2d3748 100%);
            color: #fff;
        }
        .pattern-bg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.05'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
            opacity: 0.3;
        }
        .content {
            position: relative;
            z-index: 1;
            padding: 40px 60px;
        }
        .header {
            display: flex;
            align-items: center;
            margin-bottom: 25px;
        }
        .page-number {
            background: #4B8BBE;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 18px;
            margin-right: 20px;
        }
        .title {
            font-size: 42px;
            font-weight: 700;
            color: #FFD43B;
        }
        .intro-text {
            font-size: 18px;
            line-height: 1.6;
            color: #e2e8f0;
            margin-bottom: 25px;
        }
        .two-column {
            display: flex;
            gap: 30px;
            margin-bottom: 20px;
        }
        .left-column {
            flex: 1;
        }
        .right-column {
            flex: 1;
        }
        .section-title {
            font-size: 24px;
            font-weight: 600;
            color: #e2e8f0;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
        }
        .section-title i {
            color: #FFD43B;
            margin-right: 10px;
            font-size: 20px;
        }
        .prompt-examples {
            background-color: rgba(75, 139, 190, 0.2);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
        }
        .prompt-card {
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            transition: all 0.3s ease;
        }
        .prompt-card:hover {
            transform: translateY(-3px);
            background-color: rgba(255, 255, 255, 0.15);
            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.2);
        }
        .prompt-label {
            font-size: 16px;
            font-weight: 600;
            color: #90caf9;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
        }
        .prompt-label i {
            margin-right: 8px;
        }
        .prompt-content {
            font-size: 14px;
            line-height: 1.5;
            color: #cbd5e0;
            background-color: rgba(40, 44, 52, 0.6);
            padding: 10px;
            border-radius: 6px;
            border-left: 3px solid #FFD43B;
        }
        .best-practices {
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
        }
        .practice-list {
            list-style-type: none;
            padding: 0;
        }
        .practice-item {
            display: flex;
            align-items: flex-start;
            margin-bottom: 12px;
            background-color: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            padding: 12px;
        }
        .practice-icon {
            color: #FFD43B;
            margin-right: 12px;
            font-size: 18px;
            min-width: 24px;
        }
        .practice-text {
            font-size: 15px;
            color: #e2e8f0;
            line-height: 1.4;
        }
        .code-section {
            background-color: rgba(40, 44, 52, 0.8);
            border-radius: 12px;
            padding: 20px;
            font-family: 'Consolas', 'Monaco', monospace;
            margin-bottom: 20px;
        }
        .code-prompt {
            background-color: rgba(75, 139, 190, 0.2);
            border-radius: 8px;
            padding: 10px 15px;
            margin-bottom: 15px;
            border-left: 4px solid #FFD43B;
        }
        .prompt-title {
            font-size: 16px;
            font-weight: 600;
            color: #FFD43B;
            margin-bottom: 5px;
        }
        .prompt-text {
            font-size: 14px;
            color: #e2e8f0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        .code-block {
            font-size: 14px;
            line-height: 1.5;
            color: #e2e8f0;
            white-space: pre;
            overflow-x: auto;
        }
        .keyword { color: #c678dd; }
        .string { color: #98c379; }
        .comment { color: #7f848e; font-style: italic; }
        .function { color: #61afef; }
        .variable { color: #e06c75; }
        .library { color: #e5c07b; }
        .pro-con-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-top: 20px;
        }
        .pro-con-card {
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 15px;
        }
        .pro-con-header {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }
        .pro-con-icon {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 10px;
        }
        .pro-icon {
            background-color: rgba(46, 204, 113, 0.3);
            color: #2ecc71;
        }
        .con-icon {
            background-color: rgba(231, 76, 60, 0.3);
            color: #e74c3c;
        }
        .pro-con-title {
            font-size: 18px;
            font-weight: 600;
            color: #e2e8f0;
        }
        .pro-con-list {
            list-style-type: none;
            padding: 0;
            margin: 0;
        }
        .pro-con-item {
            display: flex;
            align-items: flex-start;
            margin-bottom: 8px;
            font-size: 14px;
            color: #cbd5e0;
        }
        .pro-con-item i {
            margin-right: 8px;
            min-width: 16px;
        }
        .tips {
            font-size: 14px;
            color: #a0aec0;
            margin-top: 15px;
            font-style: italic;
            padding: 15px;
            border-left: 3px solid #FFD43B;
            background-color: rgba(255, 255, 255, 0.05);
            border-radius: 0 8px 8px 0;
        }
        .workflow-diagram {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin: 25px 0;
        }
        .workflow-step {
            background-color: rgba(75, 139, 190, 0.2);
            border-radius: 10px;
            padding: 15px;
            width: 23%;
            text-align: center;
            position: relative;
        }
        .workflow-step:not(:last-child):after {
            content: "";
            position: absolute;
            top: 50%;
            right: -13%;
            width: 13%;
            height: 2px;
            background-color: rgba(255, 212, 59, 0.5);
        }
        .workflow-step:not(:last-child):before {
            content: "➔";
            position: absolute;
            top: 50%;
            right: -13%;
            transform: translateY(-50%);
            color: #FFD43B;
            font-size: 20px;
        }
        .workflow-icon {
            font-size: 28px;
            color: #FFD43B;
            margin-bottom: 10px;
        }
        .workflow-title {
            font-size: 16px;
            font-weight: 600;
            color: #e2e8f0;
            margin-bottom: 5px;
        }
        .workflow-description {
            font-size: 14px;
            color: #cbd5e0;
            line-height: 1.4;
        }
    </style>
</head>
<body>
    <div class="slide-container">
        <div class="pattern-bg"></div>
        <div class="content">
            <div class="header">
                <div class="page-number">11</div>
                <div class="title">ChatGPT를 통한 생성형 코딩</div>
            </div>
            
            <div class="intro-text">
                ChatGPT는 코드 작성을 획기적으로 도와주는 도구로, 자동화 스크립트 개발에 매우 유용합니다. 원하는 기능을 자연어로 설명하면 ChatGPT가 실행 가능한 파이썬 코드를 생성해줍니다. 이를 통해 코딩 경험이 적은 사용자도 복잡한 자동화 작업을 쉽게 구현할 수 있습니다.
            </div>
            
            <div class="workflow-diagram">
                <div class="workflow-step">
                    <div class="workflow-icon"><i class="fas fa-comment"></i></div>
                    <div class="workflow-title">요구사항 작성</div>
                    <div class="workflow-description">원하는 자동화 기능을 명확하게 설명</div>
                </div>
                <div class="workflow-step">
                    <div class="workflow-icon"><i class="fas fa-code"></i></div>
                    <div class="workflow-title">코드 생성</div>
                    <div class="workflow-description">ChatGPT가 파이썬 코드 제안</div>
                </div>
                <div class="workflow-step">
                    <div class="workflow-icon"><i class="fas fa-edit"></i></div>
                    <div class="workflow-title">검토 및 수정</div>
                    <div class="workflow-description">생성된 코드 확인 및 조정</div>
                </div>
                <div class="workflow-step">
                    <div class="workflow-icon"><i class="fas fa-play"></i></div>
                    <div class="workflow-title">실행 및 테스트</div>
                    <div class="workflow-description">코드 실행 및 결과 검증</div>
                </div>
            </div>
            
            <div class="two-column">
                <div class="left-column">
                    <div class="prompt-examples">
                        <h3 class="section-title">
                            <i class="fas fa-comment-dots"></i>효과적인 프롬프트 작성법
                        </h3>
                        
                        <div class="prompt-card">
                            <div class="prompt-label">
                                <i class="fas fa-check-circle"></i>구체적인 요구사항 제시
                            </div>
                            <div class="prompt-content">"파이썬으로 이메일에서 첨부파일을 자동으로 다운로드하고 파일명을 날짜_보고서.xlsx 형식으로 변경하는 코드를 작성해주세요."</div>
                        </div>
                        
                        <div class="prompt-card">
                            <div class="prompt-label">
                                <i class="fas fa-check-circle"></i>원하는 라이브러리 명시
                            </div>
                            <div class="prompt-content">"pandas와 matplotlib를 사용하여 CSV 파일에서 데이터를 읽고 월별 매출 추이를 그래프로 시각화하는 코드를 작성해주세요."</div>
                        </div>
                        
                        <div class="prompt-card">
                            <div class="prompt-label">
                                <i class="fas fa-check-circle"></i>단계별 설명 요청
                            </div>
                            <div class="prompt-content">"웹사이트에서 제품 정보를 수집하는 크롤러를 BeautifulSoup으로 만들려고 합니다. 각 단계별로 주석을 달아 설명해주세요."</div>
                        </div>
                    </div>
                    
                    <div class="best-practices">
                        <h3 class="section-title">
                            <i class="fas fa-star"></i>코드 생성 모범 사례
                        </h3>
                        <ul class="practice-list">
                            <li class="practice-item">
                                <span class="practice-icon"><i class="fas fa-clipboard-list"></i></span>
                                <span class="practice-text">입력값, 출력값, 데이터 형식 등 세부 사항을 명확히 기술하세요.</span>
                            </li>
                            <li class="practice-item">
                                <span class="practice-icon"><i class="fas fa-project-diagram"></i></span>
                                <span class="practice-text">복잡한 자동화는 여러 단계로 나누어 프롬프트를 작성하고, 단계별로 코드를 생성하세요.</span>
                            </li>
                            <li class="practice-item">
                                <span class="practice-icon"><i class="fas fa-edit"></i></span>
                                <span class="practice-text">생성된 코드를 바로 사용하지 말고, 로직을 이해하고 필요시 수정하여 사용하세요.</span>
                            </li>
                            <li class="practice-item">
                                <span class="practice-icon"><i class="fas fa-lightbulb"></i></span>
                                <span class="practice-text">생성된 코드에 오류가 있으면 오류 메시지를 포함하여 수정을 요청하세요.</span>
                            </li>
                        </ul>
                    </div>
                    
                    <div class="pro-con-grid">
                        <div class="pro-con-card">
                            <div class="pro-con-header">
                                <div class="pro-con-icon pro-icon">
                                    <i class="fas fa-thumbs-up"></i>
                                </div>
                                <div class="pro-con-title">장점</div>
                            </div>
                            <ul class="pro-con-list">
                                <li class="pro-con-item">
                                    <i class="fas fa-check"></i>
                                    <span>코딩 지식이 적어도 자동화 구현 가능</span>
                                </li>
                                <li class="pro-con-item">
                                    <i class="fas fa-check"></i>
                                    <span>개발 시간 단축 (80% 이상 절약)</span>
                                </li>
                                <li class="pro-con-item">
                                    <i class="fas fa-check"></i>
                                    <span>코드에 대한 설명과 함께 학습 가능</span>
                                </li>
                                <li class="pro-con-item">
                                    <i class="fas fa-check"></i>
                                    <span>다양한 라이브러리 활용 방법 제안</span>
                                </li>
                            </ul>
                        </div>
                        
                        <div class="pro-con-card">
                            <div class="pro-con-header">
                                <div class="pro-con-icon con-icon">
                                    <i class="fas fa-thumbs-down"></i>
                                </div>
                                <div class="pro-con-title">한계</div>
                            </div>
                            <ul class="pro-con-list">
                                <li class="pro-con-item">
                                    <i class="fas fa-times"></i>
                                    <span>최신 라이브러리 문법 불일치 가능성</span>
                                </li>
                                <li class="pro-con-item">
                                    <i class="fas fa-times"></i>
                                    <span>복잡한 로직에서 오류 발생 가능</span>
                                </li>
                                <li class="pro-con-item">
                                    <i class="fas fa-times"></i>
                                    <span>환경/시스템 특화 문제 해결 제한적</span>
                                </li>
                                <li class="pro-con-item">
                                    <i class="fas fa-times"></i>
                                    <span>보안 및 최적화 고려 부족할 수 있음</span>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
                
                <div class="right-column">
                    <div class="code-section">
                        <div class="code-prompt">
                            <div class="prompt-title">ChatGPT 프롬프트:</div>
                            <div class="prompt-text">"파이썬으로 엑셀 파일에서 데이터를 읽어와 특정 조건(부서가 '영업')을 만족하는 직원들에게 이메일을 자동으로 보내는 코드를 작성해주세요."</div>
                        </div>
                        
                        <div class="code-block"><span class="comment"># ChatGPT로 생성한 직원 이메일 자동화 코드</span>
<span class="keyword">import</span> <span class="library">pandas</span> <span class="keyword">as</span> <span class="library">pd</span>
<span class="keyword">import</span> <span class="library">smtplib</span>
<span class="keyword">from</span> <span class="library">email.mime.multipart</span> <span class="keyword">import</span> MIMEMultipart
<span class="keyword">from</span> <span class="library">email.mime.text</span> <span class="keyword">import</span> MIMEText
<span class="keyword">from</span> <span class="library">datetime</span> <span class="keyword">import</span> datetime

<span class="comment"># 엑셀 파일에서 직원 데이터 읽기</span>
<span class="keyword">try</span>:
    <span class="variable">df</span> = <span class="library">pd</span>.<span class="function">read_excel</span>(<span class="string">'직원명단.xlsx'</span>)
    <span class="keyword">print</span>(<span class="string">'엑셀 파일을 성공적으로 읽었습니다.'</span>)
<span class="keyword">except</span> <span class="function">Exception</span> <span class="keyword">as</span> <span class="variable">e</span>:
    <span class="keyword">print</span>(<span class="string">f'파일 읽기 오류: {</span><span class="variable">e</span><span class="string">}'</span>)
    <span class="keyword">exit</span>()

<span class="comment"># '영업' 부서 직원 필터링</span>
<span class="variable">sales_employees</span> = <span class="variable">df</span>[<span class="variable">df</span>[<span class="string">'부서'</span>] == <span class="string">'영업'</span>]
<span class="keyword">print</span>(<span class="string">f'영업부 직원 수: {</span><span class="function">len</span>(<span class="variable">sales_employees</span>)<span class="string">}명'</span>)

<span class="comment"># 이메일 설정</span>
<span class="variable">sender_email</span> = <span class="string">"<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="443d2b31361b2129252d28042329252d286a272b29">[email&#160;protected]</a>"</span>
<span class="variable">sender_password</span> = <span class="string">"your_password"</span>  <span class="comment"># 앱 비밀번호 사용 권장</span>

<span class="comment"># 현재 날짜</span>
<span class="variable">today</span> = <span class="library">datetime</span>.<span class="function">now</span>().strftime(<span class="string">"%Y년 %m월 %d일"</span>)

<span class="comment"># 이메일 내용 템플릿</span>
<span class="variable">email_subject</span> = <span class="string">f"[공지] {</span><span class="variable">today</span><span class="string">} 영업팀 회의 안내"</span>
<span class="variable">email_body</span> = <span class="string">"""
안녕하세요, {이름}님

{today} 오후 2시에 영업팀 회의가 진행될 예정입니다.
회의실: 3층 대회의실
안건: 2분기 실적 검토 및 하반기 계획 수립

회의 자료는 첨부파일을 참고해주세요.
문의사항은 담당자(내선: 1234)에게 연락 바랍니다.

감사합니다.
"""</span>

<span class="comment"># SMTP 서버 연결</span>
<span class="keyword">try</span>:
    <span class="variable">server</span> = <span class="library">smtplib</span>.<span class="function">SMTP_SSL</span>(<span class="string">'smtp.gmail.com'</span>, 465)
    <span class="variable">server</span>.<span class="function">login</span>(<span class="variable">sender_email</span>, <span class="variable">sender_password</span>)
    <span class="keyword">print</span>(<span class="string">'이메일 서버에 로그인했습니다.'</span>)
    
    <span class="comment"># 이메일 발송</span>
    <span class="keyword">for</span> <span class="variable">index</span>, <span class="variable">row</span> <span class="keyword">in</span> <span class="variable">sales_employees</span>.iterrows():
        <span class="variable">msg</span> = <span class="function">MIMEMultipart</span>()
        <span class="variable">msg</span>[<span class="string">'From'</span>] = <span class="variable">sender_email</span>
        <span class="variable">msg</span>[<span class="string">'To'</span>] = <span class="variable">row</span>[<span class="string">'이메일'</span>]
        <span class="variable">msg</span>[<span class="string">'Subject'</span>] = <span class="variable">email_subject</span>
        
        <span class="comment"># 개인화된 메일 내용</span>
        <span class="variable">body</span> = <span class="variable">email_body</span>.format(이름=<span class="variable">row</span>[<span class="string">'이름'</span>], today=<span class="variable">today</span>)
        <span class="variable">msg</span>.attach(<span class="function">MIMEText</span>(<span class="variable">body</span>, <span class="string">'plain'</span>))
        
        <span class="variable">server</span>.<span class="function">send_message</span>(<span class="variable">msg</span>)
        <span class="keyword">print</span>(<span class="string">f"{</span><span class="variable">row</span>[<span class="string">'이름'</span>]<span class="string">}님에게 이메일을 발송했습니다."</span>)
    
    <span class="variable">server</span>.<span class="function">quit</span>()
    <span class="keyword">print</span>(<span class="string">'모든 이메일 발송이 완료되었습니다.'</span>)
    
<span class="keyword">except</span> <span class="function">Exception</span> <span class="keyword">as</span> <span class="variable">e</span>:
    <span class="keyword">print</span>(<span class="string">f'이메일 발송 오류: {</span><span class="variable">e</span><span class="string">}'</span>)</div>
                    </div>
                    
                    <div class="code-section">
                        <div class="code-prompt">
                            <div class="prompt-title">ChatGPT에게 코드 수정 요청하기:</div>
                            <div class="prompt-text">"위 코드를 더 안전하게 개선하고 싶습니다. 비밀번호를 환경변수에서 읽어오도록 하고, 예외 처리를 더 강화해주세요. 또한 HTML 형식의 이메일도 지원하도록 해주세요."</div>
                        </div>
                        
                        <div class="code-block"><span class="comment"># ChatGPT로 개선한 이메일 자동화 코드</span>
<span class="keyword">import</span> <span class="library">pandas</span> <span class="keyword">as</span> <span class="library">pd</span>
<span class="keyword">import</span> <span class="library">smtplib</span>
<span class="keyword">import</span> <span class="library">os</span>
<span class="keyword">import</span> <span class="library">logging</span>
<span class="keyword">from</span> <span class="library">email.mime.multipart</span> <span class="keyword">import</span> MIMEMultipart
<span class="keyword">from</span> <span class="library">email.mime.text</span> <span class="keyword">import</span> MIMEText
<span class="keyword">from</span> <span class="library">datetime</span> <span class="keyword">import</span> datetime
<span class="keyword">from</span> <span class="library">dotenv</span> <span class="keyword">import</span> load_dotenv

<span class="comment"># 로깅 설정</span>
<span class="library">logging</span>.<span class="function">basicConfig</span>(
    level=<span class="library">logging</span>.INFO,
    format=<span class="string">'%(asctime)s - %(levelname)s - %(message)s'</span>,
    handlers=[
        <span class="library">logging</span>.FileHandler(<span class="string">'email_automation.log'</span>),
        <span class="library">logging</span>.StreamHandler()
    ]
)
<span class="variable">logger</span> = <span class="library">logging</span>.<span class="function">getLogger</span>(<span class="string">'email_automation'</span>)

<span class="comment"># 환경 변수 로드</span>
<span class="function">load_dotenv</span>()

<span class="comment"># 이메일 발송 함수</span>
<span class="keyword">def</span> <span class="function">send_emails_to_sales_team</span>():
    <span class="keyword">try</span>:
        <span class="comment"># 엑셀 파일에서 직원 데이터 읽기</span>
        <span class="keyword">try</span>:
            <span class="variable">df</span> = <span class="library">pd</span>.<span class="function">read_excel</span>(<span class="string">'직원명단.xlsx'</span>)
            <span class="variable">logger</span>.info(<span class="string">'엑셀 파일을 성공적으로 읽었습니다.'</span>)
            
            <span class="comment"># 필수 열 확인</span>
            <span class="keyword">for</span> <span class="variable">col</span> <span class="keyword">in</span> [<span class="string">'이름'</span>, <span class="string">'부서'</span>, <span class="string">'이메일'</span>]:
                <span class="keyword">if</span> <span class="variable">col</span> <span class="keyword">not in</span> <span class="variable">df</span>.columns:
                    <span class="keyword">raise</span> <span class="function">ValueError</span>(<span class="string">f"'{</span><span class="variable">col</span><span class="string">}' 열이 엑셀 파일에 없습니다."</span>)
        <span class="keyword">except</span> <span class="function">Exception</span> <span class="keyword">as</span> <span class="variable">e</span>:
            <span class="variable">logger</span>.error(<span class="string">f'파일 읽기 오류: {</span><span class="variable">e</span><span class="string">}'</span>)
            <span class="keyword">return</span> <span class="keyword">False</span>

        <span class="comment"># '영업' 부서 직원 필터링</span>
        <span class="variable">sales_employees</span> = <span class="variable">df</span>[<span class="variable">df</span>[<span class="string">'부서'</span>] == <span class="string">'영업'</span>]
        <span class="keyword">if</span> <span class="function">len</span>(<span class="variable">sales_employees</span>) == 0:
            <span class="variable">logger</span>.warning(<span class="string">'영업 부서 직원이 없습니다.'</span>)
            <span class="keyword">return</span> <span class="keyword">False</span>
            
        <span class="variable">logger</span>.info(<span class="string">f'영업부 직원 수: {</span><span class="function">len</span>(<span class="variable">sales_employees</span>)<span class="string">}명'</span>)

        <span class="comment"># 이메일 설정</span>
        <span class="variable">sender_email</span> = <span class="library">os</span>.environ.get(<span class="string">'EMAIL_USER'</span>)
        <span class="variable">sender_password</span> = <span class="library">os</span>.environ.get(<span class="string">'EMAIL_PASSWORD'</span>)
        
        <span class="keyword">if not</span> <span class="variable">sender_email</span> <span class="keyword">or not</span> <span class="variable">sender_password</span>:
            <span class="variable">logger</span>.error(<span class="string">'이메일 계정 정보가 환경 변수에 없습니다.'</span>)
            <span class="keyword">return</span> <span class="keyword">False</span>

        <span class="comment"># HTML 템플릿</span>
        <span class="variable">html_template</span> = <span class="string">"""
        <html>
        <body>
            <h2>안녕하세요, {이름}님</h2>
            <p>{today} <strong>오후 2시</strong>에 영업팀 회의가 진행될 예정입니다.</p>
            <ul>
                <li>회의실: 3층 대회의실</li>
                <li>안건: 2분기 실적 검토 및 하반기 계획 수립</li>
            </ul>
            <p>회의 자료는 첨부파일을 참고해주세요.</p>
            <p>문의사항은 담당자(내선: 1234)에게 연락 바랍니다.</p>
            <p>감사합니다.</p>
        <script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script></body>
        </html>
        """</span>

        <span class="comment"># 일반 텍스트 버전</span>
        <span class="variable">text_template</span> = <span class="string">"""
안녕하세요, {이름}님

{today} 오후 2시에 영업팀 회의가 진행될 예정입니다.
회의실: 3층 대회의실
안건: 2분기 실적 검토 및 하반기 계획 수립

회의 자료는 첨부파일을 참고해주세요.
문의사항은 담당자(내선: 1234)에게 연락 바랍니다.

감사합니다.
        """</span>

        <span class="variable">today</span> = <span class="library">datetime</span>.<span class="function">now</span>().strftime(<span class="string">"%Y년 %m월 %d일"</span>)
        <span class="variable">email_subject</span> = <span class="string">f"[공지] {</span><span class="variable">today</span><span class="string">} 영업팀 회의 안내"</span>

        <span class="comment"># SMTP 서버 연결</span>
        <span class="keyword">try</span>:
            <span class="variable">server</span> = <span class="library">smtplib</span>.<span class="function">SMTP_SSL</span>(<span class="string">'smtp.gmail.com'</span>, 465)
            <span class="variable">server</span>.<span class="function">login</span>(<span class="variable">sender_email</span>, <span class="variable">sender_password</span>)
            <span class="variable">logger</span>.info(<span class="string">'이메일 서버에 로그인했습니다.'</span>)
            
            <span class="variable">success_count</span> = 0
            <span class="variable">fail_count</span> = 0
            
            <span class="comment"># 이메일 발송</span>
            <span class="keyword">for</span> <span class="variable">index</span>, <span class="variable">row</span> <span class="keyword">in</span> <span class="variable">sales_employees</span>.iterrows():
                <span class="keyword">try</span>:
                    <span class="variable">msg</span> = <span class="function">MIMEMultipart</span>(<span class="string">'alternative'</span>)
                    <span class="variable">msg</span>[<span class="string">'From'</span>] = <span class="variable">sender_email</span>
                    <span class="variable">msg</span>[<span class="string">'To'</span>] = <span class="variable">row</span>[<span class="string">'이메일'</span>]
                    <span class="variable">msg</span>[<span class="string">'Subject'</span>] = <span class="variable">email_subject</span>
                    
                    <span class="comment"># 개인화된 메일 내용</span>
                    <span class="variable">text_part</span> = <span class="function">MIMEText</span>(
                        <span class="variable">text_template</span>.format(이름=<span class="variable">row</span>[<span class="string">'이름'</span>], today=<span class="variable">today</span>), 
                        <span class="string">'plain'</span>
                    )
                    <span class="variable">html_part</span> = <span class="function">MIMEText</span>(
                        <span class="variable">html_template</span>.format(이름=<span class="variable">row</span>[<span class="string">'이름'</span>], today=<span class="variable">today</span>), 
                        <span class="string">'html'</span>
                    )
                    
                    <span class="variable">msg</span>.attach(<span class="variable">text_part</span>)
                    <span class="variable">msg</span>.attach(<span class="variable">html_part</span>)
                    
                    <span class="variable">server</span>.<span class="function">send_message</span>(<span class="variable">msg</span>)
                    <span class="variable">logger</span>.info(<span class="string">f"{</span><span class="variable">row</span>[<span class="string">'이름'</span>]<span class="string">}님에게 이메일을 발송했습니다."</span>)
                    <span class="variable">success_count</span> += 1
                <span class="keyword">except</span> <span class="function">Exception</span> <span class="keyword">as</span> <span class="variable">e</span>:
                    <span class="variable">logger</span>.error(<span class="string">f"{</span><span class="variable">row</span>[<span class="string">'이름'</span>]<span class="string">}님에게 이메일 발송 실패: {</span><span class="variable">e</span><span class="string">}"</span>)
                    <span class="variable">fail_count</span> += 1
            
            <span class="variable">server</span>.<span class="function">quit</span>()
            <span class="variable">logger</span>.info(<span class="string">f'이메일 발송 완료: 성공 {</span><span class="variable">success_count</span><span class="string">}건, 실패 {</span><span class="variable">fail_count</span><span class="string">}건'</span>)
            <span class="keyword">return</span> <span class="variable">success_count</span> > 0
            
        <span class="keyword">except</span> <span class="function">Exception</span> <span class="keyword">as</span> <span class="variable">e</span>:
            <span class="variable">logger</span>.error(<span class="string">f'이메일 서버 연결 오류: {</span><span class="variable">e</span><span class="string">}'</span>)
            <span class="keyword">return</span> <span class="keyword">False</span>
            
    <span class="keyword">except</span> <span class="function">Exception</span> <span class="keyword">as</span> <span class="variable">e</span>:
        <span class="variable">logger</span>.error(<span class="string">f'예상치 못한 오류: {</span><span class="variable">e</span><span class="string">}'</span>)
        <span class="keyword">return</span> <span class="keyword">False</span>

<span class="comment"># 메인 실행</span>
<span class="keyword">if</span> <span class="variable">__name__</span> == <span class="string">'__main__'</span>:
    <span class="variable">result</span> = <span class="function">send_emails_to_sales_team</span>()
    <span class="keyword">if</span> <span class="variable">result</span>:
        <span class="keyword">print</span>(<span class="string">"이메일 발송이 완료되었습니다."</span>)
    <span class="keyword">else</span>:
        <span class="keyword">print</span>(<span class="string">"이메일 발송 중 오류가 발생했습니다. 로그를 확인하세요."</span>)</div>
                    </div>
                    
                    <div class="tips">
                        <strong>Tip:</strong> ChatGPT로 생성한 코드는 항상 검토 후 사용하세요. 특히 보안 관련 부분(API 키, 비밀번호 등)은 환경 변수나 안전한 저장소를 사용하도록 수정하는 것이 좋습니다. 생성된 코드를 그대로 사용하기보다는 로직을 이해하고 필요에 맞게 조정하는 과정을 통해 코딩 실력도 함께 향상됩니다.
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
    